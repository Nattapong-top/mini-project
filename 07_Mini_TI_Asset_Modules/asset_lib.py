import os


scrip_dir = os.path.dirname(__file__)
filename = os.path.join(scrip_dir, 'assets.txt')

def load_assets():
    '''‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô List of Lists'''
    assets = []
    if os.path.exists(filename):
        with open(filename, encoding='utf-8') as f:
            for line in f:
                parts = line.strip().split(',')
                if len(parts) == 4:
                    assets.append(parts)
    return assets

def save_assets(assets):
    '''‡∏£‡∏±‡∏ö List ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡∏ö‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå (Mode 'w')'''
    with open(filename, 'w', encoding='utf-8') as f:
        for item in assets:
            # item ‡∏Ñ‡∏∑‡∏≠ ['IT-001', 'Notebook', 'Laptop', '‡∏õ‡∏Å‡∏ï‡∏¥']
            # ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏ß‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô string ‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ comma
            line = ','.join(item)
            f.write(line + '\n')
    print('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! (‡∏à‡∏≤‡∏Å lib)')

def show_all_assets(assets):
    print('\n' + '='*60)
    print(f"{'‡∏£‡∏´‡∏±‡∏™':<10} {'‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå':<25} {'‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó':<10} {'‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞':<10}")
    print('='*60)

    for item in assets:
        # item[0]=‡∏£‡∏´‡∏±‡∏™, [1]=‡∏ä‡∏∑‡πà‡∏≠, [2]=‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó, [3]=‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        print(f'{item[0]:<10} {item[1]:<25} {item[2]:<10} {item[3]:<10}')
    print('='*60)

def add_asset(assets):
    print('\n--- + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà ---')
    code = input('‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô (‡πÄ‡∏ä‡πà‡∏ô IT-001): ').strip().upper()

    for item in assets:
        if item[0] == code:
            print('‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö!')
            return
    
    name = input('‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå: ').strip()
    category = input('‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (Laptop/PC/Printer): ').strip()
    status = '‡∏õ‡∏Å‡∏ï‡∏¥'

    # ‡πÄ‡∏û‡∏¥‡πà‡∏° List ‡πÉ‡∏ô RAM ‡∏Å‡πà‡∏≠‡∏ô
    assets.append([code, name, category, status])
    # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    save_assets(assets)
    print(f'‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° {name} ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß')

def update_status(assets):
    ''' Function ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'''
    print('\n--- üîß ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ---')
    target_code = input('‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏™‡∏¥‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ: ').strip().upper()

    found = False

    # 1. ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏´‡∏≤ assets ‡∏ó‡∏µ‡πà‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö target_code
    for item in assets:
        if item[0] == target_code:
            print(f'‡πÄ‡∏à‡∏≠‡πÅ‡∏•‡πâ‡∏ß: {item[1]} (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: {item[3]})')

            # 2. ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏´‡∏°‡πà
            new_status = input('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô (‡∏õ‡∏Å‡∏ï‡∏¥/‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°/‡πÄ‡∏™‡∏µ‡∏¢): ').strip()

            # 3. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô List item[3]
            item[3] = new_status
            found = True
            print('‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢')
            break
    # ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏´‡∏≤‡πÄ‡∏à‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if found:
        # 4. ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡πÄ‡∏à‡∏≠ ‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å List ‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß ‡∏ó‡∏±‡∏ö‡∏•‡∏á‡πÑ‡∏õ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°
        save_assets(assets)
    else:
        print('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö')

def delete_asset(assets):
    print('\n--- ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô ---')
    target_code = input('‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö: ').strip().upper()

    found = False

    # ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö
    for item in assets:
        # item[0] ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
        if item[0] == target_code:
            print(f'‡πÄ‡∏à‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: {item[1]} (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: {item[3]})')

            # ‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏µ‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö (Safety)
            confirm = input('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÑ‡∏´‡∏°? (y/n): ').strip().lower()

            if confirm == 'y':
                assets.remove(item) # ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏•‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                found = True
                print('‚úÖ ‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!')
                break
            else:
                print('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö')
                return
    if found:
        save_assets(assets) # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å List ‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏ó‡∏±‡∏ö‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°
    else:
        print('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö')
