1️⃣ Problem Solving Mindset (หัวใจที่สุด)
Input: รับรายชื่อไฟล์ excel แบบไฟล์เดียวและ แบบ dir
Output: ไฟล์ excel ที่รวมกันแล้ว

Logic: 
รับรายชื่อไฟล์ excel แบบไฟล์เดียวและ แบบ dir
นำรายการไฟล์เข้าไปเก็บใน list = file_name
loop ไฟล์ทั้งหมดใน file_name
    นำข้อมูลแต่ะละ file 
    เข้าไปเก็บใน list = data_list
    ครบทุกไฟล์
นำ data_list ไปรวมกันด้วย concat
บันทึกไฟล์ to_excel
Condition / Loop: ตัดสินใจหรือวนตรงไหน
เช็คไว้เป็นไฟล์ excel ไหม
เช็คว่าสามารถรวมกันได้ไหม ถ้าไม่ได้ แจ้งเตือน เกิดจากอะไร
ถ้าผ่าน นำไฟล์ทั้งหมดมา loop

Edge Case: เคสแปลก ๆ มีไหม
ไม่ใช่ไฟล์ excel, ไฟล์ excel เสียหาย, ไฟล์ใหญ่เกิดไป, หรือข้อมูลใน file ไม่ตรงกัน 
ไฟล์มีจำนวนเยอะเกินไป

2️⃣ Algorithm Thinking (คิดเป็นขั้นตอนแบบละเอียด)
อันนี้คือ "สูตรอาหาร" ที่เราจะบอก Python ให้ทำทีละบรรทัดครับ
เตรียมตัวแปร: สร้าง List ว่างๆ ไว้ 1 อัน (สมมติชื่อ all_file_paths) เพื่อรอรับชื่อไฟล์

รับเข้า (Input):

ถ้ากดปุ่ม "เพิ่มไฟล์": เปิดหน้าต่างเลือกไฟล์ -> ได้ชื่อไฟล์ -> เช็คว่าเป็น .xlsx ไหม -> เอาใส่ all_file_paths -> แสดงชื่อบนหน้าจอ

ถ้ากดปุ่ม "เพิ่มโฟลเดอร์": เปิดหน้าต่างเลือกโฟลเดอร์ -> วนหาไฟล์ .xlsx ในนั้นทุกตัว -> เอาใส่ all_file_paths -> แสดงชื่อบนหน้าจอ

ประมวลผล (Process) - เมื่อกดปุ่ม Merge:

สร้าง List ว่างอีกอันไว้เก็บข้อมูล (สมมติชื่อ data_frames_list)

Loop: ดึงชื่อไฟล์ทีละอันจาก all_file_paths

Try (ลองทำ): อ่านไฟล์นั้นด้วย pandas

Check: ถ้าอ่านสำเร็จ -> เอาข้อมูลใส่ data_frames_list

Except (ถ้าพัง): ข้ามไฟล์นั้นไป (หรือแจ้งเตือนว่าไฟล์นี้เสีย)

Combine: สั่ง pandas.concat(data_frames_list) เพื่อรวมร่างข้อมูลทั้งหมดเป็นก้อนเดียว

ส่งออก (Output):

เปิดหน้าต่างถาม user ว่าจะเซฟไฟล์ชื่ออะไร ไว้ที่ไหน (asksaveasfilename)

สั่งบันทึกไฟล์นั้นลงเครื่อง

3️⃣ Control Flow (โครงสร้างการไหล)
อันนี้คือ "เส้นทางเดินรถ" ของข้อมูลครับ

จุดเริ่มต้น: all_file_paths = [] (ลิสต์ว่าง)

ทางแยก 1 (User Action):

ทางซ้าย -> กด Add Files -> append ชื่อไฟล์เข้าลิสต์

ทางขวา -> กด Merge

ทางแยก 2 (Validation ก่อน Merge):

เช็ค: len(all_file_paths) > 0 ไหม? (มีไฟล์ให้รวมไหม)

NO -> จบ/แจ้งเตือน "กรุณาเลือกไฟล์ก่อน"

YES -> ไปต่อ

วงวน (Loop):

หยิบไฟล์ที่ 1 -> อ่านได้ไหม? -> (ได้) เก็บ / (ไม่ได้) ข้าม

หยิบไฟล์ที่ 2 -> ...

... จนครบทุกไฟล์

จุดสิ้นสุด: Save ไฟล์ใหม่

4️⃣ Abstraction & Function (คิดเป็นชั้น)

ใน OOP เราจะแบ่งงานเป็น "ฟังก์ชันย่อยๆ" (Method) เพื่อไม่ให้โค้ดกองกันเป็นก้อนเดียวครับ จากโค้ด GUI ครั้งที่แล้ว เราจะเติมไส้ในให้ฟังก์ชันเหล่านี้ครับ:

ใน class ExcelMergerApp:

def add_files_action(self):

หน้าที่: เปิดหน้าต่างเลือกไฟล์, กรองเฉพาะ .xlsx, อัปเดตรายชื่อลงหน้าจอ

def add_folder_action(self):

หน้าที่: เปิดหน้าต่างเลือกโฟลเดอร์, วนหาไฟล์ .xlsx, อัปเดตรายชื่อลงหน้าจอ

def merge_action(self):

หน้าที่: (เป็นผู้จัดการ) เรียกใช้การอ่านไฟล์, การรวม, และการเซฟ

อาจจะแยก Logic การรวมไฟล์ไปไว้อีกฟังก์ชันลับๆ ก็ได้ เพื่อความสะอาด

5️⃣ Data Thinking (มองข้อมูลให้ขาด)

ป๋าเดาถูกแล้วครับ! พระเอกคือ List แต่มี 2 ระดับครับ

ระดับรายชื่อไฟล์ (String List):

เก็บที่อยู่ไฟล์ครับ เช่น ['C:/Users/Paa/file1.xlsx', 'D:/Work/file2.xlsx']

ตัวแปรนี้เราจะเอาไปใช้ตอน Loop อ่านไฟล์

ระดับเนื้อข้อมูล (DataFrame List):

เมื่อ pandas อ่าน Excel เข้ามา มันจะแปลงข้อมูลเป็นตาราง เรียกว่า DataFrame

เราต้องเอาตารางพวกนี้มาเรียงต่อกันใน List ก่อน เช่น [ตาราง1, ตาราง2, ตาราง3]

แล้วค่อยสั่ง concat (เหมือนทากาวแปะต่อกัน) ทีเดียวจบ

